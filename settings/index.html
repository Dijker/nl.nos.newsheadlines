<!doctype html>
<html>
    <head>

    </head>
    <body>

        <h1>News headlines (<i>nl.webchitect.newsheadlines</i>)</h1>
        <p>On this page, you will be able to adjust the settings of the News headlines app.</p>

        <fieldset>
            <legend>Settings</legend>

            <div class="field row">
                <label for="test">Amount of news articles Homey curates (min 1, max 8)</label>
                <input id="numberOfNewsArticles" type="number" value="" min="1" max="8" />
            </div>

        </fieldset>

        <button class="right" id="saver" onclick="save()">Save changes</button>

        <script type="text/javascript">
        function onHomeyReady(){
            Homey.get('numberOfNewsArticles', function(err,data) {
                document.getElementById('numberOfNewsArticles').value = data;
            });
            Homey.ready();
        }

        function save() {
            // TODO : max min news articles correct save && display correctly in value of input box immedaitely
            var newsArticles = document.getElementById('numberOfNewsArticles').value,
                button = document.getElementById('saver'),
                newsBlock = document.getElementById('numberOfNewsArticles');
            button.disabled = true;
            newsBlock.disabled = true;
            var update = "true";
            if (newsArticles > 8) { update = "trueHigh" };
            if (newsArticles < 1) { update = "trueLow" };
            var validatedNewsArticles = (newsArticles > 8 ? 8 : (newsArticles < 1 ? 1 : newsArticles));
            if(update === "true") {
                button.innerHTML = "Changes saved";
            }
            else if(update === "trueHigh") {
                button.innerHTML = "Changes saved, but selected no. of articles was reduced to maximum value of 8";
            }
            else {
                button.innerHTML = "Changes saved, but selected no. of articles was set to minimum value of 1"
            }
            setTimeout(function() {
                button.disabled = false;
                newsBlock.disabled = false;
                button.innerHTML = "Save changes"
            },3000);
            Homey.set('numberOfNewsArticles', newsArticles);
        }
        </script>

    </body>
</html>